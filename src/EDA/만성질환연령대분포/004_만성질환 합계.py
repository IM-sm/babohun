import pandas as pd
import numpy as np


df = pd.read_csv('merged_data/만성질환 환자 연령별 현황_인천포함.csv')

df = df.replace('NA', pd.NA)



print(df['구분'].unique())
df['구분'] = df['구분'].replace({
    '입원 실인원': '입원(실인원)',
    '입원 연인원': '입원(연인원)',
})

df['상병명'] = df['상병명'].replace({
    '간의질환': '간의 질환',
    '갑상선의장애': '갑상선의 장애',
    '정신및행동장애': '정신 및 행동장애',
})

age_columns = ['59세 이하', '60-64세', '65-69세', '70-79세', '80-89세', '90세 이상']
df[age_columns] = df[age_columns].apply(pd.to_numeric, errors='coerce').astype('Int64')
df.loc[df['연령별_합계'].isna(), '연령별_합계'] = df.loc[df['연령별_합계'].isna(), age_columns].sum(axis=1)


df['연령별_합계'] = pd.to_numeric(df['연령별_합계'], errors='coerce').astype('Int64')
df['연령별_합계_계산'] = df[age_columns].sum(axis=1).astype('Int64')
print(df['연령별_합계'].dtype)
print(df['연령별_합계_계산'].dtype)


df['합_일치'] = df['연령별_합계'] == df['연령별_합계_계산']
전체_일치 = df['합_일치'].all()
print(전체_일치)


for col in df.columns:
    print(f"========= Column: {col} =========")
    print(df[col].unique())

df[age_columns].replace(np.nan, 0, inplace=True)
columns = "년도,지역,구분,코드,상병명,59세 이하,60-64세,65-69세,70-79세,80-89세,90세 이상,연령별_합계".split(',')
df = df[columns]
df.to_csv('result_utf8.csv', index=False, encoding='utf-8')


"""
========= Column: 년도 =========
[2021 2022 2023]
========= Column: 지역 =========
['광주' '서울' '부산' '대전' '대구' '인천']
========= Column: 구분 =========
['입원 실인원' '입원 연인원' '외래' '입원(실인원)' '입원(연인원)']
========= Column: 코드 =========
['I10~I13, I15' 'E10~E14' 'F00~F99, G40~G41' 'A15, A16, A19'
 'I05~I09, I20~I27, I30~I52' 'I60~I69' 'G00~G37, G43~G83'
 'C00~C97, D00~D09' 'E00~E07' 'B18, B19, K70~K77' 'N18' nan]
========= Column: 상병명 =========
['고혈압' '당뇨병' '정신 및 행동장애' '호흡기결핵' '심장질환' '대뇌혈관질환' '신경계질환' '악성신생물' '갑상선의 장애'
 '간의 질환' '만성신부전증' '정신및행동장애' '갑상선의장애' '간의질환']
========= Column: 59세 이하 =========
['7' '16' '1' '2' '42' '17' '74' '48' '5' '3' '27' '303' '20' '281' '809'
 '2050' '934' '98' '46' '1912' '1747' '3285' '24' '1685' '1645' '1734'
 '612' '565' '1015' '662' nan '19' '77' '40' '15' '10' '9' '293' '5763'
 '158' '229' '227' '999' '86' '113' '2493' '3309' '5530' '30' '1226'
 '1320' '7489' '1775' '896' '1458' '1338' '0' '28' '6' '12' '276' '63'
 '663' '417' '461' '310' '831' '1121' '1402' '377' '700' '606' '318' '557'
 '709' '8' '14' '31' '4' '261' '111' '351' '785' '899' '955' '1148' '1212'
 '206' '405' '998' '319' '191' '795' '744' '11' '263' '94' '148' '248'
 '49' '154' '1261' '1416' '982' '675' '340' '1149' '245' '445' '697' '802'
 '21' '25' '57' '65' '56' '144' '954' '732' '1259' '100' '1552' '1472'
 '3109' '1134' '1487' '655' '407' '740' '640' '83' '47' '286' '5663' '257'
 '99' '867' '456' '36' '2161' '3275' '4951' '1209' '1198' '7316' '1634'
 '712' '1165' '1044' '18' '72' '76' '439' '444' '215' '53' '738' '1431'
 '361' '534' '566' '187' '253' '474' '716' '149' '375' '964' '22' '1090'
 '990' '379' '819' '399' '746' '794' '354' '80' '841' '163' '1081' '1395'
 '953' '308' '1280' '178' '505' '639' '977' '96' '84' '119' '1008' '829'
 '1755' '217' '226' '1676' '1348' '2729' '1086' '1252' '1561' '878' '398'
 '854' '1494' '78' '34' '54' '13' '259' '6009' '283' '792' '4490' '560'
 '23' '260' '1784' '2954' '4431' '1244' '1047' '6965' '1548' '784' '813'
 '1175' '124' '666' '720' '693' '29' '729' '845' '440' '682' '904' '219'
 '218' '518' '768' '249' '66' '1064' '32' '2858' '925' '1273' '224' '412'
 '1347' '305' '315' '816' '884' ' ' '538' '223' '1085' '1199' '745' '271'
 '1284' '602' '621' '171' '101' '607' '493' '64' '38' '572' '220' '524'
 '480' '26' '108' '543' '55' '58' '231' '104' '535' '269' '631' '81']
========= Column: 60-64세 =========
['1' '6' '0' '17' '10' '19' '54' '3' '93' '51' '521' '417' '1096' '1350'
 '1273' '1184' '12' '1256' '640' '1098' '490' '178' '392' '86' nan '8'
 '27' '24' '32' '7' '47' '232' '2432' '135' '550' '197' '744' '150' '83'
 '2621' '2656' '1729' '1310' '1059' '2558' '1567' '562' '889' '634' '2'
 '22' '21' '26' '48' '91' '104' '194' '80' '404' '278' '772' '1072' '654'
 '18' '518' '308' '212' '231' '306' '558' '11' '5' '4' '122' '16' '72'
 '429' '909' '1139' '461' '173' '544' '405' '259' '123' '481' '9' '29'
 '465' '264' '40' '307' '1386' '1304' '519' '678' '434' '646' '142' '322'
 '339' '508' '14' '34' '13' '62' '95' '638' '384' '825' '77' '486' '1065'
 '1060' '1083' '25' '1033' '690' '1269' '451' '201' '353' '23' '56' '164'
 '1650' '179' '160' '426' '477' '96' '2110' '2687' '1399' '1199' '862'
 '2496' '1419' '423' '776' '697' '205' '67' '229' '576' '850' '580' '438'
 '379' '359' '144' '177' '250' '466' '44' '35' '364' '749' '1039' '382'
 '175' '422' '166' '130' '240' '600' '30' '332' '171' '43' '1133' '1277'
 '495' '698' '367' '596' '97' '349' '292' '598' '41' '235' '184' '751'
 '570' '1404' '89' '1003' '904' '977' '1026' '585' '1062' '492' '351'
 '488' '15' '36' '168' '1887' '366' '276' '737' '604' '133' '1594' '2404'
 '1282' '1244' '2623' '1014' '474' '560' '499' '82' '291' '413' '513'
 '766' '553' '472' '262' '479' '127' '119' '211' '393' '148' '59' '137'
 '277' '2299' '1051' '373' '167' '314' '378' '248' '125' '284' '655' ' '
 '31' '251' '64' '851' '1089' '583' '696' '444' '79' '301' '410' '33'
 '699' '39' '74' '68' '162' '71' '620' '38' '109' '87' '37' '20' '551'
 '361' '60' '63']
========= Column: 65-69세 =========
['3' '5' '0' '1' '41' '27' '18' '67' '14' '2' '42' '26' '7' '280' '1178'
 '440' '1445' '194' '241' '2149' '1773' '1434' '9' '1975' '1121' '1655'
 '671' '358' '391' '117' nan '4' '13' '46' '79' '98' '10' '86' '1103'
 '458' '485' '761' '1171' '106' '123' '4663' '4872' '2579' '2306' '3663'
 '3063' '1182' '1241' '778' '6' '54' '25' '144' '285' '290' '521' '130'
 '217' '1533' '2091' '1199' '29' '1133' '538' '426' '713' '314' '390'
 '880' '16' '404' '283' '632' '43' '28' '1464' '1827' '847' '444' '967'
 '586' '372' '195' '60' '214' '211' '188' '68' '35' '12' '2196' '2312'
 '2229' '891' '1447' '968' '923' '345' '796' '356' '282' '359' '22' '15'
 '45' '59' '21' '191' '858' '550' '934' '75' '1906' '1569' '1503' '812'
 '1505' '574' '266' '340' '239' '20' '48' '53' '83' '47' '1515' '305'
 '262' '2202' '1154' '51' '4024' '4650' '2139' '2402' '2119' '3491' '2787'
 '1010' '869' '38' '17' '158' '102' '236' '446' '1108' '1507' '1090' '971'
 '360' '427' '368' '279' '589' '11' '8' '23' '177' '32' '127' '437' '1368'
 '760' '443' '840' '464' '336' '248' '386' '260' '89' '187' '338' '244'
 '1969' '2203' '1364' '906' '829' '720' '382' '579' '56' '34' '466' '1312'
 '442' '1304' '93' '1687' '1456' '1195' '1338' '771' '1165' '617' '245'
 '401' '885' '24' '78' '62' '1815' '490' '367' '2171' '1130' '3068' '4225'
 '1949' '2542' '1928' '4282' '2617' '980' '654' '779' '230' '168' '610'
 '496' '126' '984' '1225' '1109' '973' '523' '555' '213' '238' '243' '85'
 '1050' '2656' '1197' '1443' '807' '379' '751' '500' '506' '180' '385'
 '418' ' ' '116' '274' '147' '1740' '1783' '780' '1266' '863' '998' '307'
 '524' '322' '907' '281' '84' '886' '665' '122' '153' '225' '77' '31' '19'
 '881' '641' '114' '301' '402' '37' '173' '833' '112' '346']
========= Column: 70-79세 =========
['26' '83' '21' '11' '403' '240' '122' '590' '2' '40' '44' '219' '1828'
 '442' '166' '3486' '10391' '3822' '11278' '52' '749' '2071' '12797'
 '13888' '10178' '107' '17022' '8358' '7421' '9360' '1178' '2252' '2352'
 '4' '93' '62' '8' '650' '569' '113' '1356' '55' '121' '27' '2283' '4179'
 '126' '7087' '4748' '1878' '23534' '79' '1017' '3573' '34995' '39473'
 '20778' '199' '31916' '23489' '36350' '45205' '4582' '6595' '10792' '32'
 '7' '845' '106' '57' '358' '1' '53' '41' '390' '4234' '17' '247' '5768'
 '6014' '3379' '10156' '16' '1426' '1496' '14213' '19059' '12553' '125'
 '15239' '9419' '5219' '12276' '1841' '3006' '10203' '183' '5' nan '70'
 '103' '36' '252' '48' '68' '458' '3192' '90' '147' '4356' '2578' '4504'
 '98' '609' '695' '10177' '14064' '9412' '29' '5349' '10175' '5772' '4346'
 '1122' '1879' '4270' '175' '670' '35' '42' '58' '1033' '9318' '102'
 '7801' '3079' '1788' '3412' '418' '5601' '14212' '16510' '7362' '19'
 '16162' '8738' '12383' '6664' '3106' '1695' '4973' '28' '30' '6' '308'
 '189' '100' '568' '23' '164' '1025' '620' '163' '2350' '8364' '5407'
 '12151' '74' '291' '604' '11120' '12448' '9408' '71' '14894' '8115'
 '7752' '9358' '1160' '1945' '2386' '118' '822' '546' '170' '1373' '131'
 '2100' '3762' '151' '9563' '4398' '7271' '19611' '776' '3943' '32513'
 '42576' '18869' '214' '33548' '23055' '34319' '41932' '4472' '6033'
 '12612' '31' '3' '669' '99' '288' '37' '34' '186' '3354' '43' '4566'
 '5506' '5117' '7441' '999' '1538' '10978' '17862' '13003' '78' '15037'
 '8946' '6361' '10550' '1823' '8872' '39' '172' '0' '110' '73' '180' '82'
 '334' '3153' '346' '3027' '2897' '3490' '329' '1183' '9840' '14335'
 '8567' '6409' '10085' '5638' '4186' '1698' '4510' '18' '159' '683' '15'
 '47' '720' '6466' '24' '75' '7347' '1476' '2519' '3580' '566' '2822'
 '12035' '16739' '7559' '16450' '8938' '12393' '6599' '3448' '1876' '5962'
 '69' '104' '691' '212' '134' '583' '1684' '700' '117' '5455' '8786'
 '5699' '11398' '673' '1414' '11558' '11072' '8891' '15153' '7817' '7938'
 '9345' '1237' '2321' '4134' '65' '941' '515' '228' '1477' '12' '176'
 '2884' '3115' '337' '9759' '6971' '16501' '22557' '895' '2191' '24751'
 '41363' '17388' '340' '38085' '22930' '34392' '42637' '5380' '4706'
 '13566' '46' '761' '307' '45' '388' '1866' '202' '294' '5987' '6263'
 '6913' '6929' '976' '2299' '10685' '17485' '14294' '94' '16903' '9567'
 '7567' '11931' '1601' '2420' '10250' '61' '165' '25' '2905' '430' '2995'
 '254' '227' '3048' '3329' '2808' '105' '37572' '1518' '9109' '14118'
 '9105' '10104' '5181' '4101' '1093' '1844' '4529' '626' '114' ' ' '54'
 '789' '8317' '6706' '1506' '2600' '1801' '115' '3850' '10852' '14331'
 '7361' '16209' '8089' '12962' '6353' '3234' '1711' '7060' '22' '60' '153'
 '1836' '193' '13' '601' '731' '1150' '14' '6213' '4316' '1240' '1370'
 '2463' '2502' '1142' '203' '532' '49' '689' '548' '501' '6659' '4416'
 '1484' '608' '2664' '4011' '1457' '211' '482' '59' '771' '243' '9' '823'
 '806' '1007' '6194' '4941' '1611' '474' '2307' '3781' '1389' '232' '266']
========= Column: 80-89세 =========
['10' '21' '4' '81' '69' '26' '165' '1' '3' '24' '164' '145' '238' '108'
 '1274' '1974' '672' '4469' '18' '101' '1906' '2499' '1846' '4735' '34'
 '3090' '1924' '1591' '1860' '230' '207' '800' nan '15' '200' '88' '274'
 '8' '581' '152' '4246' '1889' '456' '5605' '138' '1471' '8550' '7225'
 '7721' '126' '7221' '5781' '5716' '8125' '797' '743' '3125' '0' '125' '2'
 '82' '7' '159' '324' '105' '1399' '513' '150' '2381' '48' '201' '78'
 '2255' '2460' '2830' '20' '2338' '1446' '676' '1760' '251' '266' '1667'
 '29' '6' '64' '700' '33' '1865' '317' '1808' '46' '1810' '2001' '3067'
 '935' '2128' '782' '1467' '147' '240' '1071' '14' '136' '489' '961' '27'
 '3824' '767' '692' '616' '16' '796' '2119' '3106' '2767' '4330' '3235'
 '2468' '1308' '1873' '431' '143' '852' '49' '45' '23' '151' '5' '51' '54'
 '424' '648' '1638' '1216' '4426' '53' '631' '2074' '1795' '4883' '2577'
 '1927' '1340' '1773' '210' '181' '969' '25' '17' '217' '107' '32' '233'
 '13' '39' '477' '914' '110' '3460' '1460' '1384' '4271' '161' '367'
 '7694' '7772' '7254' '93' '7759' '5561' '5315' '7630' '802' '719' '3907'
 '12' '74' '100' '220' '1023' '1140' '1877' '1742' '2339' '2789' '2334'
 '1382' '642' '1481' '269' '1635' '22' '79' '37' '671' '115' '1225' '195'
 '1960' '343' '1768' '1869' '2816' '11' '1165' '2112' '788' '1409' '214'
 '1351' '131' '261' '2167' '85' '1848' '325' '316' '996' '55' '2377'
 '2777' '3650' '3138' '1475' '1474' '416' '189' '1064' '173' '227' '9'
 '353' '99' '1814' '1186' '976' '5752' '369' '2290' '2049' '4797' '3233'
 '2237' '1512' '2362' '235' '1614' '334' '112' '357' '19' '618' '525' '28'
 '3851' '1063' '5136' '5004' '169' '492' '6333' '8643' '7338' '10463'
 '5923' '7512' '9768' '1238' '701' '4666' '142' '30' '94' '155' '1505'
 '2092' '754' '2151' '137' '578' '2040' '2794' '3491' '3299' '1964' '1089'
 '2037' '276' '313' '1746' '52' '96' '703' '35' '943' '41' '1954' '946'
 '2514' '12368' '332' '2008' '2522' '3378' '1317' '2531' '898' '1534'
 '202' '320' '1702' ' ' '135' '134' '1255' '57' '2570' '280' '259' '1236'
 '162' '385' '2604' '2864' '4260' '3358' '2156' '1697' '1570' '516' '247'
 '1156' '203' '563' '226' '1142' '44' '1657' '872' '736' '340' '599' '330'
 '394' '87' '569' '1543' '827' '706' '224' '825' '429' '370' '42' '60'
 '248' '76' '63' '527' '517' '579' '1438' '994' '153' '917' '1001']
========= Column: 90세 이상 =========
['3' '0' '6' '32' '16' '2' '34' '4' '56' '112' '42' '357' '374' '36'
 '1081' '64' '66' '628' '270' '1205' '30' '655' '431' '183' '331' '35'
 '50' '212' nan '8' '1' '62' '28' '429' '7' '57' '853' '399' '77' '1411'
 '182' '20' '1683' '1060' '2141' '96' '1537' '1500' '1028' '1269' '120'
 '81' '945' '27' '5' '11' '10' '48' '263' '147' '14' '317' '24' '21' '438'
 '338' '703' '451' '305' '88' '228' '39' '441' '9' '63' '145' '366' '13'
 '134' '444' '29' '674' '411' '1201' '313' '566' '237' '395' '473' '45'
 '12' '125' '351' '1559' '216' '349' '124' '760' '917' '569' '1429' '683'
 '568' '312' '501' '75' '554' '76' '22' '19' '25' '59' '523' '495' '1104'
 '85' '722' '303' '1584' '694' '654' '273' '33' '44' '169' '94' '18' '146'
 '1750' '901' '186' '1142' '65' '1896' '1354' '2378' '123' '2126' '1597'
 '1540' '1706' '133' '1163' '41' '449' '660' '140' '406' '358' '782' '562'
 '309' '127' '241' '534' '15' '26' '215' '54' '320' '741' '447' '726'
 '470' '1034' '402' '251' '376' '575' '58' '116' '167' '1164' '60' '296'
 '346' '1591' '918' '677' '1846' '962' '795' '350' '484' '137' '579' '23'
 '311' '906' '942' '1570' '729' '324' '2053' '638' '282' '176' '104' '40'
 '1296' '471' '1574' '1643' '97' '78' '1601' '1417' '2554' '99' '2744'
 '1814' '1573' '2168' '156' '1300' '46' '718' '111' '1156' '1516' '153'
 '380' '1032' '748' '359' '191' '301' '47' '328' '31' '352' '185' '1105'
 '5018' '261' '658' '365' '1098' '440' '609' '234' '327' '43' '690' ' '
 '285' '114' '1340' '425' '95' '706' '316' '92' '1037' '709' '2356' '1127'
 '862' '344' '630' '704' '17' '445' '233' '157' '528' '164' '206' '122'
 '135' '74' '151' '101' '552' '603' '179' '136' '38' '61' '109' '1563'
 '272' '410' '260' '193']
========= Column: 연령별_합계 =========
['50' '120' '49' '21' '616' '379' '261' '958' '4' '64' '77' '511' '2395'
 '795' '343' '5729' '15247' '7437' '20303' '73' '1206' '4330' '21335'
 '20797' '22021' '216' '25683' '14119' '13682' '13324' '2544' '4307'
 '4229' '147' '184' '13' '1009' '836' '173' '1905' '9' '94' '177' '27'
 '3904' '13636' '207' '12937' '8300' '3596' '33464' '82' '1679' '5383'
 '55005' '58595' '40478' '477' '45789' '35455' '56804' '61004' '8139'
 '11007' '17612' nan '34' '248' '1' '90' '156' '65' '412' '5' '91' '563'
 '4824' '600' '24' '194' '6764' '4035' '8716' '98' '782' '830' '15989'
 '20590' '16200' '78' '7420' '14785' '8780' '7076' '1810' '3580' '7234'
 '47' '241' '959' '79' '54' '3' '19' '102' '1657' '11572' '139' '13753'
 '4409' '2889' '4946' '175' '1349' '11137' '23194' '24795' '15513' '36'
 '22880' '13516' '16721' '9770' '5175' '3244' '7971' '208' '7' '985' '61'
 '206' '85' '1136' '9472' '109' '242' '10797' '1961' '3690' '5222' '992'
 '5824' '19513' '25068' '15437' '43' '23358' '13569' '16923' '9269' '5575'
 '3397' '9759' '227' '2' '8' '921' '53' '182' ' ' '14' '74' '1600' '10762'
 '31' '11027' '2228' '3178' '4003' '614' '4667' '18169' '21975' '16304'
 '40' '23401' '12605' '17729' '9157' '5121' '3210' '10858' '190' '38' '41'
 '114' '10' '807' '3117' '218' '228' '765' '1191' '2596' '11' '10590'
 '6876' '2370' '0' '2126' '3443' '3926' '1698' '361' '952' '66']
['입원 실인원' '입원 연인원' '외래' '입원(실인원)' '입원(연인원)']
Int64
Int64
True

"""